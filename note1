企微  微盘：API处需添加应用，应用：需添加可信IP

查看微盘：列出微盘中所有的文件

搜微盘 <关键字>，例如：
   * 搜微盘 报告

删微盘 <准确文件名>，例如：
   * 删微盘 test.txt

下微盘 <准确文件名>，例如：
   * 下微盘 test.txt

新建 <文件夹名> 
例如：
   * 新建 项目资料
data /config / wedrive_uploader.json 填写配置文件依次为：// 企业ID// 应用的凭证密钥//  微盘空间ID// 调试Token，可选// 应用ID// 消息推送机器人key

nohup uv run main.py > output.log 2>&1 &

# 查找进程
ps -ef | grep "uv run main.py"

# 杀死进程 (替换 12345 为实际 PID)
kill 12345

1、获取access_token  （可能两小时更新一次）
curl "https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=wwa9748681bdece041&corpsecret=uZMI2VQluqGxhGIdRxdNZRH0MF_7foL2Cb5JuAc2gBk"


2、参考：https://developer.work.weixin.qq.com/document/path/93655

注意：修改下面的access_token为上一步获取到的access_token，将执行命令设备添加到应用可信ip

请求方式：POST（HTTPS）

请求地址: https://qyapi.weixin.qq.com/cgi-bin/wedrive/space_create?access_token=VGzebE66rOz0qp5T_NwTizJDt1jBEVujzbZqWfNoekBmqY2Ko-Jz-TnRHkPgCLSqs4mM-oUSgkts7L13xPi3LViBSnzGFJ0WfyP_07QPeY-C_tufpvQoHyYN8KK8IVldq2mf00wQmZqgIumMgichoaNhP8tdukjR8xaxjTTcD_uoaAY6EjNLgxV0RGAYpo9A5o2mKh1Zbl3sWDkyqUCmFQ
{
    "space_name": "Automatic upload",
    "auth_info": [ {
        "type": 2,
        "departmentid": 1,
        "auth": 1
    }],
    "space_sub_type": 0
}

3、输出：{
    "spaceid": "s.wwa9748681bdece041.763567975WNL",
    "errcode": 0,
    "errmsg": "ok"
}

4、添加成员并设置管理员权限
请求方式：POST（HTTPS）
请求地址: https://qyapi.weixin.qq.com/cgi-bin/wedrive/space_acl_add?access_token=VGzebE66rOz0qp5T_NwTizJDt1jBEVujzbZqWfNoekBmqY2Ko-Jz-TnRHkPgCLSqs4mM-oUSgkts7L13xPi3LViBSnzGFJ0WfyP_07QPeY-C_tufpvQoHyYN8KK8IVldq2mf00wQmZqgIumMgichoaNhP8tdukjR8xaxjTTcD_uoaAY6EjNLgxV0RGAYpo9A5o2mKh1Zbl3sWDkyqUCmFQ
请求包体
{
    "spaceid": "s.wwa9748681bdece041.763567975WNL",
    "auth_info": [{
        "type": 1,
        "userid": "LiZhen",
        "auth": 7
    }]
}
userid 登陆企微，组织架构，账号=userid

该接口用于获取空间的成员列表、信息、权限等信息。

请求方式：POST（HTTPS）
请求地址: https://qyapi.weixin.qq.com/cgi-bin/wedrive/space_info?access_token=VGzebE66rOz0qp5T_NwTizJDt1jBEVujzbZqWfNoekBmqY2Ko-Jz-TnRHkPgCLSqs4mM-oUSgkts7L13xPi3LViBSnzGFJ0WfyP_07QPeY-C_tufpvQoHyYN8KK8IVldq2mf00wQmZqgIumMgichoaNhP8tdukjR8xaxjTTcD_uoaAY6EjNLgxV0RGAYpo9A5o2mKh1Zbl3sWDkyqUCmFQ

请求包体

{
    "spaceid": "s.wwa9748681bdece041.763567975WNL"
}

5、尝试创建群聊：

请求方式：POST（HTTPS）
请求地址: https://qyapi.weixin.qq.com/cgi-bin/appchat/create?access_token=VGzebE66rOz0qp5T_NwTizJDt1jBEVujzbZqWfNoekBmqY2Ko-Jz-TnRHkPgCLSqs4mM-oUSgkts7L13xPi3LViBSnzGFJ0WfyP_07QPeY-C_tufpvQoHyYN8KK8IVldq2mf00wQmZqgIumMgichoaNhP8tdukjR8xaxjTTcD_uoaAY6EjNLgxV0RGAYpo9A5o2mKh1Zbl3sWDkyqUCmFQ
请求包体
{
    "name": "双子星群聊",
    "owner": "LiZhen",
    "userlist": ["LiZhen", "WuLongChaCha"],
    "chatid": "3CbI2mU4dwPhnZ6OgyQrf9NqFStsTeRc"
}

输出：
{
    "errcode": 0,
    "errmsg": "ok",
    "chatid": "3CbI2mU4dwPhnZ6OgyQrf9NqFStsTeRc"
}

https://qyapi.weixin.qq.com/cgi-bin/wedrive/file_upload?access_token=VGzebE66rOz0qp5T_NwTizJDt1jBEVujzbZqWfNoekBmqY2Ko-Jz-TnRHkPgCLSqs4mM-oUSgkts7L13xPi3LViBSnzGFJ0WfyP_07QPeY-C_tufpvQoHyYN8KK8IVldq2mf00wQmZqgIumMgichoaNhP8tdukjR8xaxjTTcD_uoaAY6EjNLgxV0RGAYpo9A5o2mKh1Zbl3sWDkyqUCmFQ

{
  "spaceid": "s.wwa9748681bdece041.763567975WNL",
  "fatherid": "s.wwa9748681bdece041.763567975WNL",
  "file_name": "test.txt",
  "size": 39,
}